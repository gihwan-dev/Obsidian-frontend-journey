# 설계 결정 사항 (Survey 결과)

> 디자인 검증 자동화 시스템 구현을 위한 주요 결정 사항 정리

---

## 1. 프로젝트 컨텍스트

| 항목 | 결정 |
|------|------|
| 사용 시나리오 | 개발 중 수시로 Figma와 비교하며 확인 (로컬 CLI 도구) |
| 대상 범위 | 모든 UI 컴포넌트 |
| Story 커버리지 | 낮음 → 검수 시 Story 작성 유도 |

---

## 2. Figma 연동 전략

| 항목 | 결정 |
|------|------|
| 스크린샷 수집 | Figma MCP 서버 (`figma-desktop`) 활용 |
| 노드 선택 | 사용자가 Figma 프레임 링크 직접 제공 |
| 토큰 비교 | 정밀 비교 필요 (Figma variable defs 활용) |

---

## 3. Story 자동 생성 전략

| 항목 | 결정 |
|------|------|
| 생성 위치 | `__screenshots__/` 별도 디렉토리 (기존 Story와 분리) |
| Props 결정 | Figma 상태별 스크린샷과 1:1 매칭 |
| 외부 의존성 처리 | MSW로 API 모킹 + Provider 자동 래핑 |

---

## 4. 스크린샷 캡처 전략

| 항목 | 결정 |
|------|------|
| Storybook 관리 | 포트 체크 → 미실행 시 자동 실행 |
| 캡처 영역 | `#storybook-root > *` (컴포넌트 루트) |
| 테마 | 라이트 모드만 |
| 뷰포트 | Figma 프레임 크기와 동일하게 자동 맞춤 |

---

## 5. 시각적 비교 전략

| 항목 | 결정 |
|------|------|
| 비교 방식 | pixelmatch (정량) + Claude 시각 분석 (정성) |
| 임계값 | 픽셀 diff 비율 5% 이하 → Pass |
| 보고서 형식 | Markdown 파일 저장 |

---

## 6. 스크립트 및 도구

| 항목 | 결정 |
|------|------|
| 실행 환경 | Vitest 테스트로 래핑 |
| Playwright | 기존 E2E용 활용, 미설치 시 안내 |
| 아티팩트 관리 | `.gitignore`에 추가 (CI artifact 전용) |

---

## 7. 에러 처리

| 항목 | 결정 |
|------|------|
| 렌더링 실패 | 수정 시도 → 실패 시 전체 프로세스 중단 |
| 안정화 대기 | `networkidle` + 500ms 딜레이 |

---

## 8. 확장성

| 항목 | 결정 |
|------|------|
| 배치 실행 | 현재는 단일 컴포넌트만 |
| CI/CD | 현재는 로컬 CLI 도구로만 사용 |
| 기존 SKILL | 없음 (새로 구축) |
