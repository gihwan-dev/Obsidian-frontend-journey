## 트랜잭션과 Lock
- DB2, SQL Server, Sybase 등은 Lock을 통해 읽기 일관성을 구현하지만, 오라클은 Undo 데이터를 이용해 읽기 일관성을 구현
- Lock을 사용하지 않아 동시성 측면에서는 다른 DBMS 보다 우월하다 평가할 수 있음
- SQL Server도 최근 버전에서 Snapshot 모드로 설정하면 비슷한 읽기 일관성 모델로 데이터베이스를 운영할 수 있는 기능을 지원하기 시작함
- 오라클은 10g부터 대기 이벤트를 아래와 같이 분류한다:
	- Administrative: 46
	- Application: 12
	- Cluster: 47
	- Commit: 1
	- Concurrency: 24
	- Configuration: 23
	- Idle: 62
	- Network: 26
	- Other: 588
	- Scheduler: 2
	- System I/O: 24
	- User I/O: 17
- 오라클에서 발생하는 Lock 경합의 대부분을 차지하는 `enq: TM - contention`, `enq: TX - row lock contention` 이벤트는 Concurrency가 아닌 Application으로 분류돼 있다
- 함께 Application 으로 분류된 대기 이벤트 중 `SQL *Net gbreak/reset to client`가 있는데, 사용자가 수행한 SQL 문이, 존재하지 않는 테이블을 참조하거나, 사용자 정의 함수/프로시저에서 처리하지 않은 예외상황을 만났을 때 나타난다
- 테이블 Lock과 로우 Lock 관련 이벤트를 이런 유형의 프로그램 오류와 같이 분류한 것은 이들 문제가 DBA 이슈가 아니라 개발자 이슈임을 분명히 밝히고 있는것

## 트랜잭션 동시성 제어
- 동시성 제어란, 동시에 실행되는 트랜잭션 수를 최대화하면서도 입력, 수정, 삭제, 검색 시 데이터의 무결성이 유지될 수 있도록 노력하는 것을 의미
- **동시성**: 다중 사용자가 같은 데이터를 동시에 액세스
- **일관성**: 자신이 발생시킨 변경 사항과 다른 트랜잭션의 변경 사항을 포함해 일관성 있는 상태로 데이터를 제공
- 동시성과 일관성은 트레이드오프 관계에 있음

### 트랜잭션이란?
- 일관성 있게 데이터가 처리되려면 두 개 이상의 갱신연산이 동시에 실행될 수 있어야 하는데, 이는 불가능함
- 트랜잭션 관리 능력을 갖춘 DBMS는 차선책을 사용해 동시 실행을 구현함
- 여러 개의 수정작업이 하나의 작업처럼 전부 처리되거나 아예 전부 처리가 안되도록(All or Nothing) 하는 것인데, 이러한 일의 최소 단위를 트랜잭션이라고 함(트랜잭션의 원자성)
- 예를 들어, 은행 업무의 "계좌이체" 트랜잭션은 하나의 예금 계좌에서 인출해 다른 예금 계좌에 입금하는데, 이 두 작업은 하나의 단위로 함께 수행되어야 함
- 트랜잭션은 업무 처리의 기본 단위를 정의하는 것이므로 실제 어플리케이션 설계단계에서는 업무적인 관점에서 좀 더 포괄적으로 정의하게 됨
- "계좌이체"라는 트랜잭션을 정의할 때 최초 현금잔고 확인부터 이체비밀번호와 보안카드 코드값을 입력받아 최종 이체가 완료되는 순간까지를 포함해 넓게 정의할 수도 있음

### 트랜잭션의 특징
- 트랜잭션은 4가지 중요한 특성을 갖는다:
	- **원자성(Atomicity)**: 더 이상 분해가 불가능한 업무의 최소단위
	- **일관성(Consistency)**: 트랜잭션이 그 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태로 변환
	- **격리성(Isolation)**: 트랜잭션이 실행 중에 생성하는 연산의 중간 결과는 다른 트랜잭션이 접근할 수 없다
	- **영속성(Durability)**: 트랜잭션이 일단 그 실행을 성공적으로 완료하면 그 결과는 데이터베이스에 영속적으로 저장된다.
- 고가의 DBMS를 사용하는 이유는 다양하지만 무엇보다도 트랜잭션 처리 능력이 가장 기본적이고 핵심적인 요소
- 트랜잭션의 처리결과가 데이터의 일관성을 해치지 않도록 하려면 트랜잭션의 순차적 진행을 보장할 수 있는 직렬화 장치가 필요
- 이를 위해 대부분 DBMS가 Lock을 사용
- 그에 더해 오라클은 더 높은 수준의 읽기 일관성을 보장하기 위해 Undo 데이터를 활용한 독특한 읽기 일관성 모델을 사용
