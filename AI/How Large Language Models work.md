> 원문: https://medium.com/data-science-at-microsoft/how-large-language-models-work-91c362f5b78f

Large Language Models 덕분에 인공 지능은 이제 거의 모든 사람의 관심을 끌고 있다. 가장 유명하 LLM인 ChatGPT는 자연어가 매우 자연스러운 인터페이스이기 때문에 즉시 인기를 끌었고, 이로 인해 모두가 인공지능을 쉽게 사용할 수 있게 되었다. 그럼에도 불구하고, LLM이 어떻게 동작하는지는 데이터 과학자나 AI 관련 직종에 있지 않다면 여전히 잘 알려져 있지 않다. 이 글에서는 그 부분을 바꿔보려고 한다.

솔직히 말해, 그건 야심찬 목표다. 결국, 오늘날 우리가 가진 강력한 LLM들은 수십 년에 걸친 AI 연구의 결실이다. 안타깝게도, 이를 다루는 대부분의 글들은 두 가지 유형 중 하나이다. 매우 기술적이어서 많은 사전 지식을 요구하건, 너무 단순해서 읽거 나서도 알게 되는 것이 없다.

이 글은 두 가지 접근 방식 사이의 균형을 맞추기 위한 것이다. 아니, 좀 더 정확히 말하면, 완전히 처음부터 LLM이 어떻게 훈련되고 왜 그렇게 잘 작동하는지 까지 안내하는 것이 목적이다. 우리는 그 과정에서 관련된 모든 핵심 요소들만 짚어가며 설명할 것이다.

이 글은 모든 세부적인 내용을 깊이 파고들지는 않을 것이므로, 수학보다는 직관에, 그리고 가능한 한 시각 자료에 의존할 것이다. 하지만 보다시피, 세부적으로는 매우 복잡한 주제이지만, LLM의 주요 메커니즘은 매우 직관적이며, 그것만으로도 충분할 수 있다.

이 글은 또한 ChatGPT와 같은 LLM을 더 잘 활용하는 데에도 도움이 될 것이다. 실제로, 유용한 답변을 얻을 확률을 높일 수 있는 몇 가지 유용한 팁도 배울 것이다. 유명한 AI 연구자이자 엔지니어인 Andrei Karparthy가 최근에 강조해서 말했듯이, "영어는 가장 핫한 새로운 프로그래밍 언어다"라고 할 수 있다.

하지만 먼저, LLM이 인공지능의 세계에서 어디에 위치하는지부터 이해해보자.

![[Pasted image 20250803171747.png]]

AI 분야는 종종 여러 계층으로 시각화된다:

- **Artificial Intelligence (AI)**: 매우 광범위한 용어이지만, 일반적으로 지능적인 기계를 의미한다.
- **Machine Learning (ML)**: AI의 하위 분야로, 데이터에서 패턴을 인식하는 데 중점을 둔다. 패턴을 한 번 인식하면, 그 패턴을 새로운 관찰에 적용할 수 있다. 이것이 핵심 개념이며, 곧 자세히 다루겠다.
- **Deep Learning**: ML 내에서 비정형 데이터(텍스트와 이미지)에 집중하는 분야다. 이는 인공 신경망에 기반하며, 이는 두뇌에서 영감을 받은 방법이다.
- **Large Language Models (LLMs)**: 특히 텍스트를 다루며, 이 글의 주요 주제가 될 것이다.

이제 각 계층에서 관련된 핵심 요소들만을 짚어가며 설명할 것이다. 가장 바깥쪽인 인공지능(AI)은 너무 일반적이므로 건너뛰고, 바로 머신러닝부터 시작하겠다.

![[Pasted image 20250803172107.png]]

머신러닝의 목표는 데이터에서 패턴을 발견하는 것이다. 좀 더 구체적으로 말하면, 입력과 결과 사이의 관계를 설명하는 패턴을 찾는 것이다. 이것은 예시를 통해 가장 잘 설명할 수 있다.

예를 들어, 두 가지 음악 장르인 레게톤과 R&B를 구분하고 싶다고 해보자. 만약 이 장르들이 익숙하지 않다면, 이 작업을 이해하는 데 도움이 될 아주 간단하 소개를 하겠다. 레게톤은 경쾌한 비트와 춤추기 좋은 리듬으로 유명한 라틴 어반 장르이고, R&B(리듬 앤 블루스)는 아프리카계 미국인의 음악 전통에 뿌리를 둔 장르로, 감성적인 보컬과 빠른 곡과 느린 곡이 혼합된 것이 특징이다.

![[Pasted image 20250803172310.png]]

예를 들어, 20곡이 있다고 가정해보자. 우리는 각 곡의 템포와 에너지라는 두 가지 지표를 알 고 있다. 이 두 지표는 어떤 곡이든 간단히 측정하거나 계산할 수 있다. 또한, 각 곡에 레게톤 또는 R&B라는 장르 라벨을 붙여두었다. 데이터를 시각화해보면, 에너지와 템포가 높은 곡들은 주로 레게톤이고, 템포와 에너지가 낮은 곡들은 대부분 R&B 임을 알 수 있다. 이는 자연스러운 결과다.

하지만 매번 직접 장르를 라벨링하는 것은 시간이 많은 들고 확장성이 떨어진다. 대신, 곡의 지표(템포, 에너지)와 장르 사이의 관계를 학습해서, 쉽게 얻을 수 있는 지표만으로 장르를 예측할 수 있다.

머신러닝 용어로 이를 분류 문제(classificcation problem)이라고 한다. 결과 변수(장르)가 고정된 클래스/라벨(여기서는 레게톤과 R&B) 중 하나만 가질 수 있기 때문이다. 반면, 결과가 연속적인 값(예: 온도나 거리)인 경우는 회귀 문제(regression problem)이라고 한다.

우리는 이제 장르가 이미 라벨링된 데이터셋을 사용해 머신러닝 모델을 "학습(train)" 시킬 수 있다. 시각적으로 보면, 모델을 학습시키는 과정은 두 클래스를 가장 잘 구분하는 선을 찾는 것이다.

이것이 왜 유용할까? 이제 선을 알게 되었으니, 새로운 곡이 들어왔을 때 그 곡이 선의 어느 쪽에 위치하는지에 따라 레게톤인지 R&B인지 예측할 수 있다. 필요한 것은  템포와 에너지뿐이므로, 사람이 일일이 장르를 지정하는 것보다 훨씬 간단하고 확장성도 뛰어나다.

또한, 선에서 멀리 떨어지루록 예측이 더 확실하다고 볼 수 있다. 따라서 선에서의 거리를 기준으로 예측의 신뢰도를 표현할 수도 있다. 예를 들어, 새로 들어온 저 에너지, 저 템포 곡에 대해 98% 확률로 R&B라고, 2% 확률로 레게톤이라고 말할 수 있다.

![[Pasted image 20250803173229.png]]

물론 현실은 그보다 훨씬 더 복잡하다.

클래스를 구분하는 가장 좋은 경계가 반드시 직선일 필요는 없다. 즉, 입력과 결과 사이의 관계가 더 복잡할 수 있다. 위 그림처럼 곡선일 수도 있고, 그보다 훨씬 더 복잡할 수도 있다.

현실은 또 다른 면에서도 더 복잡하다. 예시처럼 입력 변수가 두 개뿐인 경우는 드물고, 실제로는 수십, 수백, 심지어 수천 개의 입력 변수가 있을 수 있다. 또한, 두 개 이상의 클래스가 존재하는 경우다 많다. 모든 클래스가 이 많은 입력 변수들과 매우 복잡하고 비선형적인 관계를 맺고 있을 수 있다.

우리의 예시에서도 실제로는 두 개 이상의 장르가 있고, 템포와 에너지 외에도 더 많은 지표가 필요하다는 것을 알고 있다. 이들 사이의 관계도 아마 그렇게 단순하지 않을 것이다.

여기서 꼭 기억해야 할 점은 이것이다: 입력과 출력 사이의 관계가 복잡해질수록, 그 관계를 학습하기 위해서는 더 복잡하고 강력한 머신러닝 모델이 필요하다는 것이다. 보통 입력 변수와 클래스의 수가 많아질수록 복잡성도 증가한다.

그리고 그에 더해, 더 많은 데이터도 필요하다. 왜 이것이 중요한지는 곧 알게 될 것이다.

![[Pasted image 20250803173655.png]]

이제 약간 다른 문제로 넘어가 보겠다. 이번에도 앞서 사용한 멘탈 모델을 적용해볼 것이다. 이번 문제에서는 입력값으로 이미지를 사용한다. 예를 들어, 가방에 들어 있는 귀여운 고양이 사진 같은 이미지다.

결과값으로는 이번에는 세 가지 라벨, 즉 호랑이, 고양이, 여우 중 하나가 있다고 가정해보자. 양 떼를 보호하기 위해 호랑이가 보이면 경보를 울리고, 고양이나 여우가 보이면 경보를 울리지 않아야 하는 상황이다.

이 역시 출력값이 몇 가지 고정된 클래스 중 하나만 가질 수 있으므로 분류 문제임을 이미 알고 있다. 따라서 이전과 마찬가지로, 라벨이 지정된 데이터(즉, 클래스 라벨이 할당된 이미지)를 사용해 머신러닝 모델을 학습시킬 수 있다.

하지만 시각적 입력을 어떻게 처리할지는 명확하지 않다. 컴퓨터는 오직 숫자 입력만 처리할 수 있기 때문이다. 앞서 곡의 에너지와 템포는 숫자였다. 다행히 이미지도 픽셀로 이루어진 숫자 입력이다. 이미지에는 높이, 너비, 그리고 세 개의 채널(빨강, 초록, 파랑)이 있다. 이론적으로는 픽셀 값을 머신러닝 모델에 바로 입력할 수 있다(여기서 공간적 요소는 일단 무시하겠다).

하지만 여기서 두 가지 문제가 생긴다. 첫째, 작은 저화질 224x224 이미지조차 15만 개가 넘는 픽셀(224x224x3)로 이루어져 있다. 앞서 입력 변수가 많아야 수백 개, 많아도 천 개 정도라고 했는데, 이제는 갑자기 최소 15만 개가 된 것이다.

둘째, 원시 픽셀과 클래스 라벨 사이의 관계를 생각해보면, 머신러닝 관점에서 그 관계는 매우 복잡하다. 인간의 뇌는 호랑이, 여우, 고양이를 쉽게 구분할 수 있지만, 15만 개의 픽셀을 하나씩 본다면 이미지에 무엇이 있는지 전혀 알 수 없다. 하지만 머신러닝 모델은 바로 이렇게 픽셀을 보기 때문에, 원시 픽셀과 이미지 라벨 사이의 관계를 처음부터 학습해야 하며, 이는 결코 쉬운 일이 아니다.

![[Pasted image 20250803183821.png]]

이번에는 또 다른 유형의 입력-출력 관계, 즉 문장과 그 감정(감성) 사이의 매우 복잡한 관계를 생각해보자. 여기서 감정이란, 문장이 전달하는 감정(예를 들어 긍정 또는 부정)을 의미한다.

문제 설정을 다시 정리해보면, 입력값은 단어들의 시퀀스, 즉 문장이고