> 참고 자료:
> https://evan-moon.github.io/2025/09/07/declarative-programming-misconceptions-and-essence/

- 특정한 도구를 사용하거나 문법을 사용하는 것이 선언적인 것이 아님
- 사고방식의 근본적 전환임
- 절차적인 동작을 함수로 추상화하면 선언적이라는 착각을 많이들 가짐

```typescript
function getUserInfo(userId) {
  const connection = connectDB();
  const userRow = connection.query('SELECT * FROM users WHERE id = ?', userId);
  const permissionRows = connection.query('SELECT * FROM permissions WHERE user_id = ?', userId);
  
  const user = {
    id: userRow.id,
    name: userRow.name,
    email: userRow.email,
    permissions: permissionRows.map(row => row.permission_name)
  };
  
  if (user.name) {
    user.displayName = user.name.toUpperCase();
  }
  
  return user;
}
```

- 위 코드는 함수로 추상화 되었지만, DB에서 사용자를 가져오고, 권한을 추가하고, 마지막에 포매팅한다 라는 시간적 순서에 집중하고 있음. 절차적임.

```typescript
const getUserInfo = (userId) => 
  pipe(
    fetchUserFromDB,
    addUserPermissions,
    formatUserData
  )(userId);
  
const getUserInfo = (userId) => 
  formatUserData(
    addUserPermissions(
      fetchUserFromDB(userId)
    )
  );
```

- 위 코드는 시간적 순서에서 벗어나 동작 간의 관계를 기술하고 있음.

- 절차적 코드는 "어떻게 단계별로 실행할 것인가"에 집중하고, 선언적 코드는 "무엇을 원하는 관계인가"에 집중

- `map`을 사용한다고 선언적이지 않음

```typescript
// 배열 메소드를 사용했지만 절차적 사고
function processItems(items) {
  return items
    .map(item => {
      let price = item.basePrice;

      if (item.discount) {
        price = price * (1 - item.discount);
      }

      price = price * 1.1;

      return { ...item, finalPrice: Math.round(price * 100) / 100 };
    })
    .filter(item => item.finalPrice > 0);
}
```

- 위 코드는 절차적임
- 반면 아래 코드는 선언적임

```javascript
// 진정한 선언적 접근
const processItems = (items) =>
  items
    .map(applyDiscount)
    .map(addTax)
    .map(formatPrice)
    .filter(hasValidPrice);

const applyDiscount = (item) => ({
  ...item,
  price: item.basePrice * (1 - (item.discount || 0))
});

const addTax = (item) => ({
  ...item,
  price: item.price * 1.1
});

const formatPrice = (item) => ({
  ...item,
  finalPrice: Math.round(item.price * 100) / 100
});

const hasValidPrice = (item) => item.finalPrice > 0;
```

- 절차적 접근은 레시피와 같음:
	- 물 2컵을 끓인다. 면을 넣고 3분간 끓인다. 스프를 넣고 1분간 더 끓인다. 그릇에 담는다.
- 선언적 접근은 관계를 표현함:
	- 라면 = 삶은 면 + 스프 + 뜨거운 물의 조함
- 절차적 접근은 시간의 흐름에 따른 행동 지침이고, 관계적 선언은 재료들 사이의 본질적 관계를 나타냄
