오늘 읽었던 내용들에서는 갖가지 맥스게이지 화면이 눈앞을 스치는 그런 내용들이 많았던거 같아요!! 대시보드를 중점으로 하다 보니 도메인 지식이 쌓이지 않는거 같아서 고민이 많았는데, 요즘은 조금씩 눈에 보이는 것들이 생기는거 같아서 너무 좋습니다~ㅎㅎ

오늘은 **오라클 성능 관리**에 대한 내용을 읽었습니다. 보통 성능을 관리할 때 아래와 같은 절차를 따른다고 해요:

1. 쿼리 성능에 문제가 생기면 **Explain Plan을 통해 실행계획을 확인**
2. 그것만으로 정확한 판단이 어렵다면 `AutoTrace`를 걸어 실제 일량을 측정하거나, `SQL 트레이스`를 걸어 내부 수행 절차가 어느 단계에서 부하를 일으키는지 눈으로 확인
3. 문제점이 파악되면 **쿼리 변환 또는 옵티마이저 힌트**를 사용해 튜닝
4. 그것만으로 부족하다면 **인덱스 조정**을 병행

`explain plan` 이라는 명령을 통해서 `plan_table`에 SQL에 대한 실행 계획을 저장할 수 있다고 하네요! 유심히 봤던 내용 중 하나는 `SQL 트레이스` 에 관한 내용이었습니다.

SQL 트레이스는 튜닝할 때 가장 많이 사용되는 도구라고 합니다. 사전 실행계획과 AutoTrace 만으로 부하원인을 찾을 수 없을 때, SQL 트레이스를 통해 찾아낼 수 있다고 합니다.

이 트레이스에 저장되는 정보는 이미지로 첨부했습니다!!

SQL문 바로 아래에 Call 칼럼들이 있는데 각 의미는:
	- `call`:
		- `Parse`: 커서를 파싱하고 실행계획을 생성하는 데 대한 통계
		- `Execute`: 커서의 실행 단계에 대한 통계
		- `Fetch`: 레코드를 실제로 `fetch` 하는데 대한 통계
	- `count`: `Parse`, `Execute`, `Fetch` 각 단계가 수행된 횟수
	- `cpu`: 현재 커서가 각 단계에서 사용한 `cpu time`
	- `elapsed`: 현재 커서가 각 단계를 수행하는 데 소요된 시간
	- `disk`: 디스크로부터 읽은 블록 수
	- `query`: Consistent 모드에서 읽은 버퍼 블록 수
	- `current`: Current 모드에서 읽은 버퍼 블록 수
	- `rows`: 각 단계에서 읽거나 처리한 건수

라고 합니다!

커서가 뭐지? 하고 찾아봤는데, 데이터베이스에서 **커서(Cursor)**는 **SQL 문을 실행하기 위한 메모리 작업 영역**입니다. SQL 문 하나당 하나의 커서가 필요하다고 생각하면 된다고 합니다ㅎㅎ

하드 파싱 과정을 거쳐 메모리에 적재된 SQL과 Parse Tree, 실행계획, 그리고 그것을 실행하는데 필요한 정보를 담은 SQL Area를 말합니다.

그리고 가장 오~ 하며 봤던 부분은 CPU Time과 Elapsed Time의 차이에 대한 부분이었습니다ㅎㅎ 너무 자주 보는 값들인데 단 한번도 자세히 들여다 보지 않았더라고요~~

- **CPU Time** = OS 레벨에서 해당 프로세스가 실제로 CPU 코어를 사용한 시간
- **Elapsed Time** = CPU Time + Wait Time = Response 시점 - Call 시점

이라고 하네요! 그래서 Elapsed Time은 **사용자로부터 데이터베이스 Call을 받은 순간부터 Response를 보내는 순간까지의 소요 시간**을 의미한다고 합니다ㅎㅎ

이외에도 `sql_plan_statistics` 뷰 관련 내용을 읽으면서, 이런 이유로 SQL Detail 페이지에서 이 데이터를 요청할 때 이런 파라미터들이 필요하구나... 뭐 그런 생각도 하고 재밌게 읽었습니다!

내용을 뭔가 튜닝의 마스터가 되겠다 라는 느낌 보단 어떻게 돌아가는지 한 번 보자 라는 생각으로 읽으니까 재밌고 빠르게 진도가 나가는거 같습니다!!

[링크](https://publish.obsidian.md/gihwan-dev/DB/%EC%98%A4%EB%9D%BC%ED%81%B4+%EC%84%B1%EB%8A%A5+%EA%B3%A0%EB%8F%84%EC%99%80+%EC%9B%90%EB%A6%AC%EC%99%80+%ED%95%B4%EB%B2%95+I/%EC%98%A4%EB%9D%BC%ED%81%B4+%EC%84%B1%EB%8A%A5+%EA%B3%A0%EB%8F%84%ED%99%94+%EC%9B%90%EB%A6%AC%EC%99%80+%ED%95%B4%EB%B2%95+-+10.30#DMBS_XPLAN+%ED%8C%A8%ED%82%A4%EC%A7%80)에 정리해뒀으니 한 번 보셔도 좋을거 같아요~~

아침부터 아주 만족스럽습니다~~ 벌써 목요일 이네요ㅎㅎ 다들 목요팅 입니다!! 겨울도 가을도 애매한 날씨라 이거 만만하게 보다가 감기 걸리기 좋은거 같습니다~~ 다들 건강도 잘 챙기십쇼~!
