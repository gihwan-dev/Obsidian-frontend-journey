# 타입 세이프 라우팅 시스템

## 메타데이터
- **상태**: ✅ resolved
- **담당자**: 최기환
- **작성자**: 최기환
- **생성일**: 2025-03-10
- **완료일**: 2025-09-18
- **Product**: Maxgauge VI
- **ClickUp**: [링크](https://app.clickup.com/t/86ert2hx6)

---

## 요약

타입 안전성이 보장된 라우팅 시스템 구현. `useTypedRouter`와 `useTypedQueryParams` 두 개의 핵심 커스텀 훅을 통해 타입 오류를 방지하고 개발 경험을 향상.

---

## 핵심 훅

### useTypedRouter

타입 안전성이 보장된 네비게이션 함수 제공.

```typescript
import { useTypedRouter } from '@/shared/libs/route/useTypedRouter';

function MyComponent() {
  const navigate = useTypedRouter();

  // 기본 경로로 이동 (자동 완성 지원)
  const goToDashboard = () => {
    navigate({ path: '/dashboard' });
  };

  // 쿼리 파라미터와 함께 이동
  const goToDashboardWithParams = () => {
    navigate({
      path: '/dashboard',
      params: {
        period: 'weekly', // 'daily' | 'weekly' | 'monthly' 중 하나만 가능
        view: 'grid',     // 'grid' | 'list' 중 하나만 가능
      },
    });
  };

  // 경로 파라미터와 함께 이동
  const goToUserDetail = (userId: string) => {
    navigate({
      path: '/users/:id',
      routeParams: { id: userId }, // 필수 파라미터
    });
  };
}
```

### useTypedQueryParams

현재 페이지의 쿼리 파라미터를 타입 안전하게 관리.

```typescript
import { useTypedQueryParams } from '@/shared/libs/route/useTypedQueryParams';

function DashboardPage() {
  const { params, updateParams, getParam, setParam } = useTypedQueryParams('/dashboard');

  // params 타입: { period?: 'daily' | 'weekly' | 'monthly', view?: 'grid' | 'list' }
  console.log('Period:', params.period);

  // 여러 파라미터 한 번에 업데이트
  const switchToMonthlyGrid = () => {
    updateParams({ period: 'monthly', view: 'grid' });
  };

  // 단일 파라미터 업데이트
  const toggleView = () => {
    setParam('view', params.view === 'grid' ? 'list' : 'grid');
  };
}
```

---

## 새로운 라우트 추가하기

`types.ts` 파일에서 타입 정의 업데이트:

```typescript
// src/shared/libs/route/types.ts

// 1. RoutePath에 새 경로 추가
export type RoutePath =
  | '/'
  | '/dashboard'
  | '/users'
  | '/users/:id'
  | '/new-feature'; // 새 경로

// 2. 쿼리 파라미터 정의 추가
export interface RouteQueryParams {
  '/dashboard': {
    period?: 'daily' | 'weekly' | 'monthly';
    view?: 'grid' | 'list';
  };
  '/new-feature': {
    mode?: 'basic' | 'advanced';
    id?: string;
  };
}
```

---

## 고급 사용법

### 중첩 라우트
```typescript
navigate({
  path: '/projects/:projectId/tasks/:taskId',
  routeParams: { projectId: '123', taskId: '456' },
  params: { view: 'details' },
});
```

### 선택적 파라미터
```typescript
export interface RouteParams {
  '/users/:id?': { id?: string };
}
```

---

## 전체 예제: 사용자 관리 페이지

```typescript
function UserListPage() {
  const navigate = useTypedRouter();
  const { params, updateParams } = useTypedQueryParams('/users');

  const currentPage = Number(params.page || '1');
  const searchTerm = params.search || '';

  const handlePageChange = (newPage: number) => {
    updateParams({ page: String(newPage) });
  };

  const handleSearch = (term: string) => {
    updateParams({ search: term, page: '1' }); // 검색 시 첫 페이지로
  };

  const goToUserDetail = (userId: string) => {
    navigate({
      path: '/users/:id',
      routeParams: { id: userId },
    });
  };
}
```
